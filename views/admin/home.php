<?php

if(!defined("IN_SITE")) {
    exit("The Request Not Found");
}
$body = ["title" => __("Dashboard") . " | " . $CMSNT->site("title"), "desc" => $CMSNT->site("description"), "keyword" => $CMSNT->site("keywords")];
$body["header"] = "\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js\"></script>\n";
$body["footer"] = "\n \n \n";
require_once __DIR__ . "/../../models/is_admin.php";
require_once __DIR__ . "/header.php";
require_once __DIR__ . "/sidebar.php";
echo "<div class=\"main-content app-content\">\n    <div class=\"container-fluid\">\n        <div class=\"d-md-flex d-block align-items-center justify-content-between my-4 page-header-breadcrumb\">\n            <h1 class=\"page-title fw-semibold fs-18 mb-2\"><i class=\"fa-solid fa-chart-line\"></i> Dashboard</h1>\n            <div class=\"float-right\">\n                \n            </div>\n        </div>\n        ";
if(checkPermission($getUser["admin"], "view_license")) {
    echo "        <div class=\"alert alert-secondary alert-dismissible fade show custom-alert-icon shadow-sm\" role=\"alert\">\n            <h5>";
    echo $config["project"];
    echo " Version: <strong style=\"color:blue;\">";
    echo $config["version"];
    echo "</strong></h5>\n            ";
    if($CMSNT->site("status_update") == 1) {
        echo "            <small>Hệ thống sẽ tự động cập nhật phiên bản mới khi bạn truy cập trang này, để tắt chức năng này quý khách\n                vào menu <strong>Cài Đặt</strong> -> <strong>Cài đặt chung</strong> -> <strong>Cập nhật phiên bản tự\n                    động</strong> -> <strong>Chọn OFF</strong>.</small>\n            ";
    } else {
        echo "            <small>Bạn đang tắt chức năng cập nhật phiên bản, để bật chức năng này quý khách\n                vào menu <strong>Cài Đặt</strong> -> <strong>Cài đặt chung</strong> -> <strong>Cập nhật phiên bản tự\n                    động</strong> -> <strong>Chọn ON</strong>.</small>\n            ";
    }
    echo "            <br>\n            <hr>\n            <p>Cộng đồng của chúng tôi:</p>\n            <ul>\n                <li>Nhóm Zalo: ";
    echo $CMSNT->site("status_demo") == 1 ? "<strong>chỉ áp dụng khi mua website chính hãng tại CMSNT</strong>" : "<a class=\"text-primary\" href=\"https://zalo.me/g/idapcx933\" target=\"_blank\">[CMSNT]\n                        Changelog - Notification</a>";
    echo "</li>\n                <li>Nhóm Zalo: ";
    echo $CMSNT->site("status_demo") == 1 ? "<strong>chỉ áp dụng khi mua website chính hãng tại CMSNT</strong>" : "<a class=\"text-primary\" href=\"https://zalo.me/g/eululb377\" target=\"_blank\">[CMSNT] Trao\n                        đổi API - Suppliers</a>";
    echo "</li>\n                <li>Nhóm Telegram: ";
    echo $CMSNT->site("status_demo") == 1 ? "<strong>chỉ áp dụng khi mua website chính hãng tại CMSNT</strong>" : "<a class=\"text-primary\" href=\"https://t.me/+LVON7y2BKWU3ZDY9\" target=\"_blank\">[CMSNT]\n                        Tìm kiếm API - Suppliers</a>";
    echo "</li>\n                <li>Kênh Telegram:\n                    ";
    echo $CMSNT->site("status_demo") == 1 ? "<strong>chỉ áp dụng khi mua website chính hãng tại CMSNT</strong>" : "<a class=\"text-primary\" href=\"https://t.me/cmsntco\" target=\"_blank\">[CMSNT] Changelog - Notification</a>";
    echo "                </li>\n            </ul>\n            <a class=\"btn btn-outline-primary btn-wave btn-sm\" type=\"button\"\n                    href=\"https://www.messenger.com/t/101939031161934?ref=kiemtrabanquyenwebsite\" target=\"_blank\"><i class=\"fa-brands fa-facebook-messenger\"></i> FANPAGE KIỂM TRA BẢN QUYỀN</a>\n                        <a class=\"btn btn-outline-secondary btn-wave btn-sm\" type=\"button\"\n                    href=\"https://t.me/cmsnt_bot\" target=\"_blank\"><i class=\"fa-brands fa-telegram\"></i> BOT KIỂM TRA BẢN QUYỀN</a>\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"><i\n                    class=\"bi bi-x\"></i></button>\n        </div>\n        ";
}
echo "        ";
if($CMSNT->site("smtp_status") != 1) {
    echo "        <div class=\"alert alert-warning alert-dismissible fade show custom-alert-icon shadow-sm\" role=\"alert\">\n            <svg class=\"svg-warning\" xmlns=\"http://www.w3.org/2000/svg\" height=\"1.5rem\" viewBox=\"0 0 24 24\"\n                width=\"1.5rem\" fill=\"#000000\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n                <path d=\"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z\" />\n            </svg>\n            Vui lòng cấu hình <b>SMTP</b> để sử dụng toàn bộ tiện ích từ Mail:\n            <a class=\"text-primary\"\n                href=\"https://help.cmsnt.co/huong-dan/huong-dan-cau-hinh-smtp-vao-website-shopclone7/\"\n                target=\"_blank\">Xem Hướng Dẫn</a>\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"><i\n                    class=\"bi bi-x\"></i></button>\n        </div>\n        ";
}
echo "        ";
if($CMSNT->site("debug_auto_bank") == 1) {
    echo "        <div class=\"alert alert-danger alert-dismissible fade show custom-alert-icon shadow-sm\" role=\"alert\">\n            <svg class=\"svg-danger\" xmlns=\"http://www.w3.org/2000/svg\" height=\"1.5rem\" viewBox=\"0 0 24 24\"\n                width=\"1.5rem\" fill=\"#000000\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n                <path\n                    d=\"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3zm1-4.3h-2V7h2v6z\" />\n            </svg>\n            Vui lòng tắt chức năng <b>Debug Auto Bank</b> khi không gặp vấn đề về Auto Bank. Tắt chức năng này trong Cài\n            Đặt -> ON/OFF Debug Auto Bank\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"><i\n                    class=\"bi bi-x\"></i></button>\n        </div>\n        ";
}
echo "        <div class=\"row\">\n            ";
if(checkPermission($getUser["admin"], "view_statistical")) {
    echo "            <div class=\"col-12\">\n                <div class=\"text-right mb-3\">\n                    <img src=\"";
    echo base_url("mod/img/gif-live.gif");
    echo "\" width=\"60px\">\n                </div>\n            </div>\n            <!-- Thành viên đăng ký toàn thời gian -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card primary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-primary\">\n                                    <i class=\"fa-solid fa-users fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Thành viên đăng ký</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_users_all\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-primary-transparent\">Toàn thời gian</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Đơn hàng đã bán toàn thời gian -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card secondary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-info\">\n                                    <i class=\"fa-solid fa-cart-shopping fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Đơn hàng đã bán</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_orders_all\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-info-transparent\">Toàn thời gian</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Doanh thu đơn hàng toàn thời gian -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card warning\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-warning\">\n                                    <i class=\"fa-solid fa-chart-simple fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Doanh thu đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_pay_all\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-warning-transparent\">Toàn thời gian</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Lợi nhuận đơn hàng toàn thời gian -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card danger\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-danger\">\n                                    <i class=\"fa-solid fa-money-bill-trend-up fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Lợi nhuận đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"profit_all\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-danger-transparent\">Toàn thời gian</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- Thành viên đăng ký tháng này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card primary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-primary\">\n                                    <i class=\"fa-solid fa-users fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Thành viên đăng ký</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"new_users_month\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-primary-transparent\">Tháng ";
    echo date("m", time());
    echo "</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- Đơn hàng đã bán tháng này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card secondary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-info\">\n                                    <i class=\"fa-solid fa-cart-shopping fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Đơn hàng đã bán</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_orders_month\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-info-transparent\">Tháng ";
    echo date("m", time());
    echo "</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n\n            <!-- Doanh thu đơn hàng tháng này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card warning\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-warning\">\n                                    <i class=\"fa-solid fa-chart-simple fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Doanh thu đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_pay_month\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-warning-transparent\">Tháng ";
    echo date("m", time());
    echo "</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Lợi nhuận đơn hàng tháng này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card danger\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-danger\">\n                                    <i class=\"fa-solid fa-money-bill-trend-up fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Lợi nhuận đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"profit_month\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-danger-transparent\">Tháng ";
    echo date("m", time());
    echo "</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- Thành viên đăng ký hôm nay -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card primary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-primary\">\n                                    <i class=\"fa-solid fa-users fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Thành viên đăng ký</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"new_users_today\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-primary-transparent\">Hôm nay</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- Đơn hàng đã bán hôm nay -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card secondary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-info\">\n                                    <i class=\"fa-solid fa-cart-shopping fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Đơn hàng đã bán</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_orders_today\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-info-transparent\">Hôm nay</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Doanh thu đơn hàng hôm nay -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card warning\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-warning\">\n                                    <i class=\"fa-solid fa-chart-simple fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Doanh thu đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_pay_today\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-warning-transparent\">Hôm nay</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Lợi nhuận đơn hàng hôm nay -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card danger\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-danger\">\n                                    <i class=\"fa-solid fa-money-bill-trend-up fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Lợi nhuận đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"profit_today\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-danger-transparent\">Hôm nay</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <script>\n            function show_thong_ke_dashboard() {\n                \$.ajax({\n                    url: '";
    echo base_url("ajaxs/admin/view.php");
    echo "',\n                    method: 'POST',\n                    dataType: 'JSON',\n                    data: {\n                        action: 'show_thong_ke_dashboard',\n                        token: '";
    echo $getUser["token"];
    echo "'\n                    },\n                    beforeSend: function() {\n                        \$('.spinner').show(); // Hiển thị icon spin\n                    },\n                    success: function(data) {\n                        \$('#total_orders_today').text(data.total_orders_today);\n                        \$('#total_pay_today').text(data.total_pay_today);\n                        \$('#profit_today').text(data.profit_today);\n                        \$('#new_users_today').text(data.new_users_today);\n                        \$('#total_orders_month').text(data.total_orders_month);\n                        \$('#total_pay_month').text(data.total_pay_month);\n                        \$('#profit_month').text(data.profit_month);\n                        \$('#new_users_month').text(data.new_users_month);\n                        \$('#total_orders_all').text(data.total_orders_all);\n                        \$('#total_pay_all').text(data.total_pay_all);\n                        \$('#profit_all').text(data.profit_all);\n                        \$('#total_users_all').text(data.total_users_all);\n                    },\n                    complete: function() {\n                        \$('.spinner').hide(); // Ẩn icon spin\n                    }\n                });\n            }\n\n            \$(document).ready(function() {\n                show_thong_ke_dashboard(); // Cập nhật dữ liệu ngay khi tải trang\n                setInterval(show_thong_ke_dashboard, 5000); // Cập nhật dữ liệu mỗi 5 giây\n            });\n            </script>\n\n            <div class=\"col-xl-6\">\n                <div class=\"card custom-card\">\n                    <div class=\"card-header\">\n                        <div class=\"card-title\">THỐNG KÊ ĐƠN HÀNG THÁNG ";
    echo date("m");
    echo "</div>\n                    </div>\n                    <div class=\"card-body\">\n                        <canvas id=\"chartjs-line\" class=\"chartjs-chart\"></canvas>\n                        <script>\n                        (function() {\n                            document.addEventListener('DOMContentLoaded', function() {\n                                setTimeout(function() {\n                                    Chart.defaults.borderColor = \"rgba(142, 156, 173,0.1)\";\n                                    Chart.defaults.color = \"#8c9097\";\n\n                                    \$.ajax({\n                                        url: '";
    echo base_url("ajaxs/admin/view.php");
    echo "',\n                                        method: 'POST',\n                                        dataType: 'json',\n                                        data: {\n                                            action: 'view_chart_thong_ke_don_hang_thang',\n                                            token: '";
    echo $getUser["token"];
    echo "'\n                                        },\n                                        success: function(response) {\n                                            const labels = response.labels;\n                                            const revenues = response.revenues;\n                                            const profits = response.profits;\n\n                                            const data = {\n                                                labels: labels,\n                                                datasets: [{\n                                                        label: 'Doanh thu',\n                                                        backgroundColor: 'rgb(132, 90, 223)',\n                                                        borderColor: 'rgb(132, 90, 223)',\n                                                        data: revenues,\n                                                    },\n                                                    {\n                                                        label: 'Lợi nhuận',\n                                                        backgroundColor: 'rgb(73,182,245)',\n                                                        borderColor: 'rgb(73,182,245)',\n                                                        data: profits,\n                                                    }\n                                                ]\n                                            };\n\n                                            const config = {\n                                                type: 'bar',\n                                                data: data,\n                                                options: {}\n                                            };\n\n                                            const myChart = new Chart(\n                                                document.getElementById(\n                                                    'chartjs-line'),\n                                                config\n                                            );\n                                        }\n                                    });\n                                }, 5);\n                            });\n                        })();\n                        </script>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"col-xl-6\">\n                <div class=\"card custom-card\">\n                    <div class=\"card-header\">\n                        <div class=\"card-title\">THỐNG KÊ NẠP TIỀN THÁNG ";
    echo date("m");
    echo "</div>\n                    </div>\n                    <div class=\"card-body\">\n                        <canvas id=\"chartjs-naptien\" class=\"chartjs-chart\"></canvas>\n                        <script>\n                        (function() {\n                            document.addEventListener('DOMContentLoaded', function() {\n                                setTimeout(function() {\n                                    Chart.defaults.borderColor = \"rgba(142, 156, 173,0.1)\";\n                                    Chart.defaults.color = \"#8c9097\";\n\n                                    \$.ajax({\n                                        url: '";
    echo base_url("ajaxs/admin/view.php");
    echo "',\n                                        method: 'POST',\n                                        dataType: 'json',\n                                        data: {\n                                            action: 'view_chart_thong_ke_nap_tien_thang',\n                                            token: '";
    echo $getUser["token"];
    echo "'\n                                        },\n                                        success: function(response) {\n                                            const labels = response.labels;\n                                            const data = response.data;\n\n                                            const chartData = {\n                                                labels: labels,\n                                                datasets: [{\n                                                    label: 'Tổng tiền nạp',\n                                                    backgroundColor: 'rgb(132, 90, 223)',\n                                                    borderColor: 'rgb(132, 90, 223)',\n                                                    data: data,\n                                                }]\n                                            };\n\n                                            const config = {\n                                                type: 'bar',\n                                                data: chartData,\n                                                options: {\n                                                    scales: {\n                                                        y: {\n                                                            beginAtZero: true\n                                                        }\n                                                    }\n                                                }\n                                            };\n\n                                            const myChart = new Chart(\n                                                document.getElementById(\n                                                    'chartjs-naptien'),\n                                                config\n                                            );\n                                        }\n                                    });\n                                }, 5);\n                            });\n                        })();\n                        </script>\n                    </div>\n                </div>\n            </div>\n\n\n\n            ";
}
echo "            ";
if(checkPermission($getUser["admin"], "view_recent_transactions")) {
    echo "            <div class=\"col-xl-6\">\n                <div class=\"card custom-card\">\n                    <div class=\"card-header\">\n                        <div class=\"card-title\">ĐƠN HÀNG GẦN ĐÂY</div>\n                        <div class=\"ms-auto\">\n                            <img class=\"text-right\" src=\"";
    echo base_url("mod/img/gif-live.gif");
    echo "\" width=\"60px\">\n                        </div>\n                    </div>\n                </div>\n                <ul class=\"timeline list-unstyled orders-timeline\"\n                    style=\"height:500px;overflow-x:hidden;overflow-y:auto;\">\n\n                </ul>\n            </div>\n            <div class=\"col-xl-6\">\n                <div class=\"card custom-card\">\n                    <div class=\"card-header\">\n                        <div class=\"card-title\">NẠP TIỀN GẦN ĐÂY</div>\n                        <div class=\"ms-auto\">\n                            <img class=\"text-right\" src=\"";
    echo base_url("mod/img/gif-live.gif");
    echo "\" width=\"60px\">\n                        </div>\n                    </div>\n                </div>\n                <ul class=\"timeline list-unstyled deposits-timeline\"\n                    style=\"height:500px;overflow-x:hidden;overflow-y:auto;\">\n\n                </ul>\n            </div>\n            <script>\n            function fetchOrders() {\n                \$.ajax({\n                    url: \"";
    echo base_url("ajaxs/admin/view.php");
    echo "\",\n                    method: 'POST',\n                    data: {\n                        action: 'view_don_hang_gan_day',\n                        token: '";
    echo $getUser["token"];
    echo "'\n                    },\n                    success: function(html) {\n                        \$('.orders-timeline').html(html);\n                    }\n                });\n            }\n\n            function fetchDeposits() {\n                \$.ajax({\n                    url: \"";
    echo base_url("ajaxs/admin/view.php");
    echo "\",\n                    method: 'POST',\n                    data: {\n                        action: 'view_nap_tien_gan_day',\n                        token: '";
    echo $getUser["token"];
    echo "'\n                    },\n                    success: function(html) {\n                        \$('.deposits-timeline').html(html);\n                    }\n                });\n            }\n            setInterval(fetchOrders, 5000);\n            setInterval(fetchDeposits, 5000);\n\n            \$(document).ready(function() {\n                fetchOrders();\n                fetchDeposits();\n            });\n            </script>\n            ";
}
echo "        </div>\n    </div>\n</div>\n\n\n";
require_once __DIR__ . "/footer.php";
echo "<script type=\"text/javascript\">\nnew ClipboardJS(\".copy\");\n\nfunction copy() {\n    showMessage('Đã sao chép vào bộ nhớ tạm', 'success');\n}\n</script>";

?>